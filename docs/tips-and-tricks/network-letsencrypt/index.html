<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.75">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Jellyfin Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Jellyfin Blog Atom Feed"><title data-react-helmet="true">Let&#x27;s Encrypt | Jellyfin</title><meta data-react-helmet="true" property="og:url" content="http://next.jellyfin.org/docs/tips-and-tricks/network-letsencrypt"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" name="og:type" content="website"><meta data-react-helmet="true" name="twitter:site" content="@jellyfin"><meta data-react-helmet="true" property="og:title" content="Let&#x27;s Encrypt | Jellyfin"><meta data-react-helmet="true" name="description" content="LetsEncrypt with Certbot"><meta data-react-helmet="true" property="og:description" content="LetsEncrypt with Certbot"><meta data-react-helmet="true" property="og:image" content="http://next.jellyfin.org/img/social.png"><meta data-react-helmet="true" name="twitter:image" content="http://next.jellyfin.org/img/social.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="http://next.jellyfin.org/docs/tips-and-tricks/network-letsencrypt"><link data-react-helmet="true" rel="alternate" href="http://next.jellyfin.org/docs/tips-and-tricks/network-letsencrypt" hreflang="en"><link data-react-helmet="true" rel="alternate" href="http://next.jellyfin.org/docs/tips-and-tricks/network-letsencrypt" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.7ff4a8cc.css">
<link rel="preload" href="/assets/js/runtime~main.143f2ea0.js" as="script">
<link rel="preload" href="/assets/js/main.11cab31a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Jellyfin logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Jellyfin logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/features">Features</a><a class="navbar__item navbar__link" href="/clients">Clients</a><a class="navbar__item navbar__link" href="/plugins">Plugins</a><a class="navbar__item navbar__link" href="/downloads">Downloads</a><a class="navbar__item navbar__link" href="/contribute">Contribute</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/getting-started">Documentation</a><a class="navbar__item navbar__link" href="/contact">Contact</a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Jellyfin logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Jellyfin logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/features">Features</a></li><li class="menu__list-item"><a class="menu__link" href="/clients">Clients</a></li><li class="menu__list-item"><a class="menu__link" href="/plugins">Plugins</a></li><li class="menu__list-item"><a class="menu__link" href="/downloads">Downloads</a></li><li class="menu__list-item"><a class="menu__link" href="/contribute">Contribute</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/getting-started">Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/contact">Contact</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/installing-jellyfin">Installing the server</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/admin-building">Building from source</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/setup-live-tv">Setting up live TV</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Client configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/clients/kodi">Kodi</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/clients/mopidy">Installing Mopidy Extension</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/clients/clients-web-config">Jellyfin Web Configuration</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Server configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/configuration/general-configuration">General information</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/configuration/admin-hardware-acceleration">Hardware Acceleration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/configuration/networking">Networking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/configuration/admin-troubleshoot">Troubleshooting</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Organizing your media</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/media/server-media-books">Books</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/media/server-media-internet-radio">Internet radio</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/media/server-media-movies">Movies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/media/server-media-music">Music</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/media/server-media-shows">Shows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/media/server-media-subtitles">Subtitles</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugins/server-plugins-index">Installing plugins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugins/server-plugins-open-subtitles">Open Subtitles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/plugins/server-plugins-tvheadend">TVHeadend</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Using with a reverse proxy</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reverse-proxy/network-reverse-proxy-apache">Apache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reverse-proxy/network-reverse-proxy-caddy">Caddy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reverse-proxy/network-reverse-proxy-haproxy">HAProxy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reverse-proxy/network-reverse-proxy-nginx">Nginx</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reverse-proxy/network-reverse-proxy-traefik">Traefik v1.x</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reverse-proxy/network-reverse-proxy-traefik2">Traefik v2.x</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Server administration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/server-devices">Devices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/network-dlna">DLNA</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/server-libraries">Libraries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/live-tv">Live TV</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/server-notifications">Notifications</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/server-quick-connect">Quick Connect</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/server-settings">Settings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/server-storage">Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/server-tasks">Tasks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/server-transcoding">Transcoding</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Users</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/users/server-users-managing">Managing Users</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server/users/server-users-index">Users</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tips &amp; tricks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tips-and-tricks/clients-css-customization">CSS Customization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tips-and-tricks/fail2ban-jellyfin">fail2ban</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/tips-and-tricks/network-letsencrypt">Let&#x27;s Encrypt</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tips-and-tricks/migrations">Migrations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tips-and-tricks/monitoring">Monitoring</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Let&#x27;s Encrypt</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="letsencrypt-with-certbot"></a>LetsEncrypt with Certbot<a class="hash-link" href="#letsencrypt-with-certbot" title="Direct link to heading">#</a></h2><p>LetsEncrypt is a service that provides free SSL/TLS certificates to users. Certbot is a client that makes this easy to accomplish and automate. In addition, it has plugins for Apache and Nginx that make automating certificate generation even easier.</p><p>Installation instructions for most Linux distributions can be found on the <a href="https://certbot.eff.org/docs/install.html#operating-system-packages" target="_blank" rel="noopener noreferrer">Certbot</a> website.</p><p>Once the packages are installed, you&#x27;re ready to generate a new certificate.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="apache"></a>Apache<a class="hash-link" href="#apache" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="certbot-apache-plugin"></a>Certbot Apache Plugin<a class="hash-link" href="#certbot-apache-plugin" title="Direct link to heading">#</a></h4><p>After installing Certbot and the Apache plugin, certificate generation is accomplished by with the following command.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">certbot certonly --apache --noninteractive --agree-tos --email YOUR_EMAIL -d DOMAIN_NAME</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Update the &#x27;SSLCertificateFile&#x27; and &#x27;SSLCertificateKeyFile&#x27; sections, then restart the service.</p><p>Add a job to cron so the certificate will be renewed automatically.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">echo &quot;0 0 * * *  root  certbot renew --quiet --no-self-upgrade --post-hook &#x27;systemctl reload apache2&#x27;&quot; | sudo tee -a /etc/cron.d/renew_certbot</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="certbot-webroot"></a>Certbot Webroot<a class="hash-link" href="#certbot-webroot" title="Direct link to heading">#</a></h4><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="debian"></a>Debian<a class="hash-link" href="#debian" title="Direct link to heading">#</a></h5><p>If the certbot apache plugin doesn&#x27;t work with your config, use webroot instead.</p><p>Add the following to your <code>&lt;VirtualHost&gt;</code> section after configuring it a reverse proxy:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly conf"><div tabindex="0" class="prism-code language-conf codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">DocumentRoot /var/www/html/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#Do not pass the .well-known directory when using certbot and webroot</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ProxyPass /.well-known !</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Run the certbot command as root:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo certbot certonly --webroot -w /var/www/html --agree-tos --email YOUR_EMAIL -d DOMAIN_NAME</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="haproxy"></a>HAProxy<a class="hash-link" href="#haproxy" title="Direct link to heading">#</a></h3><p>HAProxy doesn&#x27;t currently have a Certbot plugin. To get around this, run Certbot in standalone mode and proxy traffic through your network.</p><p>Enable the frontend and backend in the config above, and then run Certbot.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">certbot certonly --standalone --preferred-challenges http-01 --http-01-port 8888 --noninteractive --agree-tos --email YOUR_EMAIL -d DOMAIN_NAME</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The port can be changed to anything you like, but be sure that the HAProxy config and your Certbot command match.</p><p>HAProxy needs to have the certificate and key files concatenated into the same file to read it correctly. This can be accomplished with the following command.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">cat /etc/letsencrypt/live/DOMAIN_NAME/fullchain.pem /etc/letsencrypt/live/DOMAIN_NAME/privkey.pem &gt; /etc/ssl/DOMAIN_NAME.pem</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Uncomment <code>bind *:443</code> and the redirect section in the configuration, then reload the service.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="automatic-certificate-renewal"></a>Automatic Certificate Renewal<a class="hash-link" href="#automatic-certificate-renewal" title="Direct link to heading">#</a></h4><p>Place the following script in <code>/usr/local/bin/</code> to automatically update your SSL certificate.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">SITE=DOMAIN_NAME</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># move to the correct let&#x27;s encrypt directory</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd /etc/letsencrypt/live/$SITE</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># cat files to make combined .pem for haproxy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cat fullchain.pem privkey.pem &gt; /etc/ssl/$SITE.pem</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># reload haproxy</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service haproxy reload</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Make sure the script is executable.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">chmod u+x /usr/local/bin/letsencrypt-renew.sh</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Add a job to cron so the certificate will be renewed automatically.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly data"><div tabindex="0" class="prism-code language-data codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@monthly /usr/bin/certbot renew --renew-hook &quot;/usr/local/bin/letsencrypt-renew.sh&quot; &gt;&gt; /var/log/letsencrypt-renewal.log</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="nginx"></a>Nginx<a class="hash-link" href="#nginx" title="Direct link to heading">#</a></h3><p>After installing Certbot and the Nginx plugin with <code>sudo apt install certbot python3-certbot-nginx</code>, generate the certificate.</p><p><strong>Note</strong>: For Fedora Linux distributions (e.g. CentOS 8) use <code>sudo dnf install python3-certbot-nginx</code> to install the Nginx plugin.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo certbot --nginx --agree-tos --redirect --hsts --staple-ocsp --email YOUR_EMAIL -d DOMAIN_NAME</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Add the <code>--rsa-key-size 4096</code> parameter if you want a 4096 bit key instead.</p><p>Copy and paste the whole Nginx sample configuration file from above, changing the parameters according to your setup and uncommenting the lines.</p><p>Add a job to cron so the certificate will be renewed automatically.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">echo &quot;0 0 * * *  root  certbot renew --quiet --no-self-upgrade --post-hook &#x27;systemctl reload nginx&#x27;&quot; | sudo tee -a /etc/cron.d/renew_certbot</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="lets-encrypt-and-docker"></a>Let&#x27;s Encrypt and Docker<a class="hash-link" href="#lets-encrypt-and-docker" title="Direct link to heading">#</a></h3><p>This section assumes that Jellyfin is running in a Docker container (on Linux). This section also assumes that you wish to run Let&#x27;s Encrypt in a Docker container as well. The Linuxserver/swag Docker container has a built-in nginx webserver to handle the reverse proxy.</p><p>Linuxserver/letsencrypt is deprecated in favor of linuxserver/swag, see <a href="https://github.com/linuxserver/docker-swag#migrating-from-the-old-linuxserverletsencrypt-image" target="_blank" rel="noopener noreferrer">here</a> for information on how to migrate if needed.</p><p>First, you need to determine a few things.</p><ol><li><strong>MAKE SURE YOU HAVE A CNAME FOR JELLYFIN WITH YOUR DNS PROVIDER BEFORE PROCEEDING</strong></li><li>Where you wish to store information regarding Let&#x27;s Encrypt (docker calls these &quot;volumes&quot;)</li><li>What subdomain or subfolder you wish to use with Let&#x27;s Encrypt (ex. jellyfin.example.com)</li><li>What timezone you wish to use</li><li>If you&#x27;ll be using either HTTP-01 or DNS-01 for challenges.</li><li>What network you&#x27;ll be running on (I&#x27;d recommend the default macvlan network called &quot;br0&quot;)</li><li>What IP you want your container running on</li><li>What ports you&#x27;ll be using (ex. 180 for port 80, and 1443 for 443)</li><li>Make sure ports 80 (if using http validation) and 443 are forwarded to the docker container from your router (instructions vary upon manufacturer)</li><li>What user will the container be running as (you can determine the PUID and PGID by running <code>id</code> (replacing &quot;user&quot; with the username of the user the container will be running as)</li></ol><p>List of DNS Plugins <a href="https://certbot.eff.org/docs/using.html#dns-plugins" target="_blank" rel="noopener noreferrer">here</a> if using DNS-01 challenge.</p><p>Then, depending on what those settings are, you&#x27;ll need to adjust the values below as needed.</p><p>For example, the docker create command from the LinuxServer team for the Swag Docker container:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker create \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --name=swag \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --cap-add=NET_ADMIN \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e PUID=1000 \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e PGID=1000 \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e TZ=Europe/London \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e URL=example.com \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e SUBDOMAINS=www, \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e VALIDATION=http \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e DNSPLUGIN=cloudflare `#optional` \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e DUCKDNSTOKEN=&lt;token&gt; `#optional` \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e EMAIL=&lt;e-mail&gt; `#optional` \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e DHLEVEL=2048 `#optional` \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e ONLY_SUBDOMAINS=false `#optional` \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e EXTRA_DOMAINS=&lt;extradomains&gt; `#optional` \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -e STAGING=false `#optional` \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -p 443:443 \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -p 80:80 `#optional` \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -v &lt;/path/to/appdata/config&gt;:/config \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --restart unless-stopped \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  linuxserver/swag</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Assuming I follow this template and adjust for my region, ports, and path, it would look like this (with personal information redacted):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker create --name=swag --cap-add=NET_ADMIN -e PUID=1000 -e PGID=1000 -e TZ=America/Chicago -e URL=example.com -e SUBDOMAINS=jellyfin -e VALIDATION=http -e EMAIL=email@email.com -e DHLEVEL=2048 -e ONLY_SUBDOMAINS=false -e STAGING=false -p 443:443 -p 80:80 -v /path/to/appdata/swag/:/config --restart unless-stopped linuxserver/swag</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This will pull down the linuxserver/letsencrypt container, and then create it with the variables specified. You&#x27;ll then want to start the docker container with <code>docker start swag</code>. You can verify this is started by running <code>docker ps</code>, which will produce an output like this:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><div tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">CONTAINER ID        IMAGE                     COMMAND             CREATED             STATUS              PORTS                                      NAMES</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">09346434b8ea        linuxserver/swag          &quot;/init&quot;             2 minutes ago       Up 5 seconds        0.0.0.0:80-&gt;80/tcp, 0.0.0.0:443-&gt;443/tcp   swag</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>At this point, navigate to what volume you selected (in my example, it&#x27;s <code>/mnt/swag</code>). You&#x27;ll then need to navigate to <code>nginx/proxy-confs</code> within that directory. If you list the contents of that directory, you&#x27;ll see a lot of files.</p><p>The one we&#x27;re interested in for jellyfin is <code>jellyfin.subdomain.conf.sample</code> (if using a subdomain) or <code>jellyfin.subfolder.conf.sample</code> (if using a subfolder). You&#x27;ll want to copy the file needed, removing the .sample (ex. <code>cp jellyfin.subdomain.conf.sample jellyfin.subdomain.conf</code>). Open the file in your text editor of choice.</p><p>It should look like this (this file is <code>jellyfin.subdomain.conf</code>, although <code>jellyfin.subfolder.conf</code> looks very similar):</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly nginx"><div tabindex="0" class="prism-code language-nginx codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">server {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    listen 443 ssl;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    listen [::]:443 ssl;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    server_name jellyfin.*;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    include /config/nginx/ssl.conf;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    client_max_body_size 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    location / {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        include /config/nginx/proxy.conf;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        resolver 127.0.0.11 valid=30s;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set $upstream_app jellyfin;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set $upstream_port 8096;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set $upstream_proto http;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_pass $upstream_proto://$upstream_app:$upstream_port;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header Range $http_range;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header If-Range $http_if_range;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    location ~ (/jellyfin)?/socket/ {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        include /config/nginx/proxy.conf;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        resolver 127.0.0.11 valid=30s;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set $upstream_app jellyfin;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set $upstream_port 8096;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set $upstream_proto http;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_pass $upstream_proto://$upstream_app:$upstream_port;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header Upgrade $http_upgrade;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header Connection $http_connection;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The lines we&#x27;re interested in is <code>set $upstream_app jellyfin</code>. Now, assuming Jellyfin and Let&#x27;s Encrypt are on the same network within Docker, it <em>should</em> see it and start handling reverse proxy without much issue. If it doesn&#x27;t however, you&#x27;ll just need to change <code>jellyfin</code> in that line to whatever the IP of your Jellyfin server is. We&#x27;ll also look at the line <code>location ~ (/jellyfin)?/socket</code> and add a slash after socket, so the line should look like this <code>location ~ (/jellyfin)?/socket/</code>.</p><p>Then, within Jellyfin settings (Dashboard -&gt; Networking), scroll down to &quot;Public HTTP port number&quot; and &quot;Public HTTPS port number&quot;, and make sure HTTP Port number is 8096, while HTTPS port number is 8920.</p><p>Restart your Let&#x27;s Encrypt docker container by running <code>docker restart swag</code>, and then you can follow the logs with <code>docker logs -f swag</code>. Assuming everything works, you should see <code>Server Ready</code> at the very end of the logs. This tells you Lets Encrypt is running without issue.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/jellyfin/jellyfin.org/edit/master/docs/tips-and-tricks/letsencrypt.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/tips-and-tricks/fail2ban-jellyfin"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« fail2ban</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/tips-and-tricks/migrations"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Migrations »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#letsencrypt-with-certbot" class="table-of-contents__link">LetsEncrypt with Certbot</a><ul><li><a href="#apache" class="table-of-contents__link">Apache</a></li><li><a href="#haproxy" class="table-of-contents__link">HAProxy</a></li><li><a href="#nginx" class="table-of-contents__link">Nginx</a></li><li><a href="#lets-encrypt-and-docker" class="table-of-contents__link">Let&#39;s Encrypt and Docker</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started</a></li><li class="footer__item"><a href="https://developer.jellyfin.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Developer Documentation</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/community-standards">Community Standards</a></li><li class="footer__item"><a href="https://matrix.to/#/+jellyfin:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Matrix</a></li><li class="footer__item"><a href="https://discord.gg/zHBxVSXdBV" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://reddit.com/r/jellyfin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reddit</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/getting-help">Getting Help</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/faq">FAQ</a></li><li class="footer__item"><a href="https://github.com/jellyfin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Check us out on GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Site content is licensed <a href="http://creativecommons.org/licenses/by-nd/4.0/">CC-BY-ND-4.0</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.143f2ea0.js"></script>
<script src="/assets/js/main.11cab31a.js"></script>
</body>
</html>